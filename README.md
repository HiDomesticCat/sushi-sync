# Sushi Sync - Restaurant Simulation

A Japanese-style restaurant simulation and visualization tool built with Tauri, Rust, and Svelte.

## üöÄ Getting Started

### Prerequisites
- Node.js (v16+)
- Rust (latest stable)
- Tauri prerequisites (see [Tauri Docs](https://tauri.app/v1/guides/getting-started/prerequisites))

### Installation
```bash
npm install
```

### Running the Application
```bash
npm run tauri dev
```

---

## üß† Backend Implementation (Operating System Concepts)

The backend is implemented in Rust and leverages several core Operating System concepts to simulate a multi-threaded restaurant environment.

### 1. Process & Thread Management
- **Multi-threading**: Each customer family is treated as an independent "process" (implemented as a Rust thread).
- **Concurrency**: Threads run concurrently, simulating real-world arrival and dining behaviors.

### 2. Resource Allocation & Synchronization
- **Monitor Pattern**: Uses `Arc<Mutex<SushiResources>>` and `Condvar` to implement a monitor. This ensures thread-safe access to shared resources (seats, baby chairs, wheelchairs).
- **Condition Variables (`Condvar`)**: When resources are unavailable, customer threads enter a "Waiting" state and are suspended. They are notified via `notify_all()` whenever a family leaves and releases resources.
- **Deadlock Prevention**: Resources are checked and allocated atomically within a mutex lock to prevent race conditions and inconsistent states.

### 3. Scheduling Logic
- **Resource Constraints**:
    - **Seats**: Categorized into Single (Bar), 4P (Sofa), and 6P (Sofa).
    - **Special Needs**: Wheelchair-accessible seats and baby chairs are limited global resources.
- **Allocation Strategy**:
    - Individuals prefer Bar seats but can fallback to Sofas.
    - Families prefer Sofas.
    - Wheelchair users are restricted to accessible Sofa seats.
    - 4-person families can "downgrade" to 4 consecutive Bar seats if Sofas are full.

---

## üé® Frontend Features & Implementation

The frontend is built with **Svelte 5** and **Tailwind CSS**, focusing on a clean, Japanese-inspired aesthetic.

### 1. Interactive Floor Plan (`RestaurantMap`)
- **Visual Feedback**: Real-time visualization of seat occupancy.
- **Sub-slot Rendering**: Sofa seats (4P/6P) show individual occupants and baby chair placements.
- **Status Indicators**: Icons for wheelchairs, baby chairs, and family IDs.

### 2. Configuration Modals
- **Seat Configuration**: Customize the number and type of seats available in the restaurant.
- **Customer Configuration**: Manually add customers or load sample data. Define arrival times, party sizes, and special requirements.

### 3. Simulation Controls & Playback
- **Master Timeline**: A global slider to scrub through the simulation time.
- **Playback Engine**: Supports play/pause and variable speed playback.
- **Log Terminal**: Displays real-time system logs generated by the backend, formatted like OS kernel logs.

### 4. Analysis & Visualization (`AnalysisPanel`)
- **OS Metrics**:
    - **Throughput**: Families processed per unit of time.
    - **Turnaround Time**: Total time from arrival to departure.
    - **Wait Time**: Time spent in the "Ready Queue" (Waiting Area).
    - **Resource Contention**: Tracks how many times customers had to wait due to resource unavailability.
- **Detailed Selection**: Click on any seat or family to see their specific history and properties.

### 5. Data Export
- Supports exporting simulation results to **JSON**, **CSV**, or **Plain Text** for further analysis.

---

## üõ†Ô∏è Project Structure

- **`src-tauri/src/simulation.rs`**: Core simulation engine using threads and monitors.
- **`src/stores/`**: Svelte stores managing global state (simulation frames, playback, configuration).
- **`src/components/`**: Modular UI components for the map, timeline, and analysis.

## üìù Recent Updates
- Implemented multi-threaded simulation with Rust `Condvar`.
- Added OS-oriented performance metrics in the Analysis Panel.
- Enhanced visualization for wheelchair and baby chair distribution.
